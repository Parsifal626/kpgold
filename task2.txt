Список, содержащий ФИО и время разговора по суткам:
sql
Copy code
SELECT a.ФИО, z.время_разговора
FROM Звонки z
JOIN Абоненты a ON z.номер_телефона = a.телефон
WHERE DATE(z.дата_разговора) = CURRENT_DATE;

Список звонков, где время разговора за сутки больше 5 минут:
sql
Copy code
SELECT *
FROM Звонки
WHERE DATE(дата_разговора) = CURRENT_DATE AND время_разговора > 5;


Список звонков, где перерывы между звонками не более 5 минут:
sql
Copy code
SELECT z1.*
FROM Звонки z1
LEFT JOIN Звонки z2 ON z1.номер_телефона = z2.номер_телефона
                      AND z1.дата_разговора = z2.дата_разговора
                      AND z1.время_разговора < z2.время_разговора
WHERE z2.время_разговора - z1.время_разговора <= 5;


Список, содержащий информацию по абонентам:
sql
Copy code
SELECT a.ФИО,
       COUNT(z.номер_телефона) AS количество_звонков_в_день,
       AVG(z.время_разговора) AS среднее_время_разговора,
       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY z.время_разговора) AS медиана_разговора,
       MAX(z.время_разговора) - MIN(z.время_разговора) AS размах_разговора
FROM Абоненты a
LEFT JOIN Звонки z ON a.телефон = z.номер_телефона AND DATE(z.дата_разговора) = CURRENT_DATE
GROUP BY a.ФИО;